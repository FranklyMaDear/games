<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Magic Animal Holes</title>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
  
  <!-- Favicon and PWA Meta Tags -->
  <link rel="icon" type="image/png" href="index.png">
  <link rel="apple-touch-icon" href="index.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Magic Animal Holes">
  <meta name="theme-color" content="#667eea">
  <meta name="msapplication-TileImage" content="index.png">
  <meta name="msapplication-TileColor" content="#667eea">
  <link rel="manifest" href="manifest.json">
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    body {
      font-family: 'Arial', cursive;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      overflow-x: hidden;
      touch-action: manipulation;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    /* Ad Banner Styles */
    .ad-banner {
      position: fixed;
      top: -70px;
      left: 0;
      width: 100%;
      background: linear-gradient(90deg, #ff6b6b, #feca57, #48dbfb, #ff6b6b);
      background-size: 400% 400%;
      color: white;
      text-align: center;
      padding: 15px;
      font-size: clamp(0.8rem, 2.5vw, 1rem);
      font-weight: bold;
      z-index: 10000;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      animation: gradientShift 3s ease infinite, slideBanner 20s ease-in-out infinite;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: top 0.5s ease;
    }

    .ad-banner.show {
      top: 0;
    }

    .ad-banner .ad-emoji {
      font-size: 1em;
    }

    .ad-banner .ad-text {
      flex: 1;
    }

    .ad-banner .ad-close {
      background: rgba(255, 255, 255, 0.3);
      border: none;
      color: white;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8em;
      cursor: pointer;
      flex-shrink: 0;
    }

    @keyframes gradientShift {
      0% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
      100% {
        background-position: 0% 50%;
      }
    }

    @keyframes slideBanner {
      0%, 100% {
        top: -70px;
      }
      10%, 90% {
        top: 0;
      }
    }

    /* Flying Ads Animals */
    .flying-ad {
      position: absolute;
      font-size: clamp(1.5rem, 4vw, 2rem);
      z-index: 9999;
      pointer-events: auto;
      cursor: pointer;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      animation-duration: 20s;
      animation-timing-function: linear;
      animation-iteration-count: infinite;
      opacity: 0.9;
      transition: opacity 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .flying-ad:hover {
      opacity: 1;
    }

    .flying-ad .ad-label {
      position: absolute;
      top: -25px;
      background: rgba(255, 0, 0, 0.9);
      color: white;
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 0.6em;
      font-weight: bold;
      white-space: nowrap;
    }

    @keyframes flyTopToBottom {
      0% {
        transform: translateY(-100px) translateX(0);
      }
      100% {
        transform: translateY(calc(100vh + 100px)) translateX(100px);
      }
    }

    @keyframes flyBottomToTop {
      0% {
        transform: translateY(calc(100vh + 100px)) translateX(0);
      }
      100% {
        transform: translateY(-100px) translateX(-100px);
      }
    }

    @keyframes flyLeftToRight {
      0% {
        transform: translateX(-100px) translateY(0);
      }
      100% {
        transform: translateX(calc(100vw + 100px)) translateY(100px);
      }
    }

    @keyframes flyRightToLeft {
      0% {
        transform: translateX(calc(100vw + 100px)) translateY(0);
      }
      100% {
        transform: translateX(-100px) translateY(-100px);
      }
    }

    .screen {
      display: none;
      width: 100%;
      min-height: 100vh;
      padding: 15px;
      padding-top: 70px; /* Space for ad banner */
    }

    .screen.active {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    #welcomeScreen {
      background: linear-gradient(135deg, #ff6b6b 0%, #feca57 50%, #48dbfb 100%);
    }

    .welcome-title {
      font-size: clamp(2rem, 6vw, 3rem);
      color: white;
      text-align: center;
      margin-bottom: 10px;
      text-shadow: 3px 3px 0 rgba(0, 0, 0, 0.2);
      padding: 0 10px;
    }

    .welcome-subtitle {
      font-size: clamp(1rem, 3vw, 1.5rem);
      color: white;
      text-align: center;
      margin-bottom: 10px;
      opacity: 0.9;
      padding: 0 10px;
    }

    .choose-title {
      font-size: clamp(1.3rem, 4vw, 2rem);
      color: white;
      text-align: center;
      margin: 15px 0;
      text-shadow: 2px 2px 0 rgba(0, 0, 0, 0.2);
      background: rgba(255, 255, 255, 0.3);
      padding: 10px 20px;
      border-radius: 20px;
      border: 3px solid white;
      width: 90%;
      max-width: 400px;
    }

    .difficulty-selector,
    .character-selector {
      width: 90%;
      max-width: 400px;
      margin: 15px 0;
    }

    .dropdown-container {
      position: relative;
      width: 100%;
    }

    .dropdown-header {
      background: rgba(255, 255, 255, 0.95);
      padding: 15px;
      border-radius: 15px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: clamp(1rem, 3vw, 1.3rem);
      border: 3px solid #FFD700;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
    }

    .selected-difficulty,
    .selected-character {
      display: flex;
      align-items: center;
      gap: 10px;
      overflow: hidden;
    }

    .selected-emoji {
      font-size: clamp(1.5rem, 4vw, 2rem);
      flex-shrink: 0;
    }
    
    .selected-name {
      color: #333;
      font-weight: bold;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .dropdown-arrow {
      font-size: 1.2em;
      transition: transform 0.3s ease;
      flex-shrink: 0;
    }

    .dropdown-arrow.open {
      transform: rotate(180deg);
    }

    .dropdown-list {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      border-radius: 10px;
      margin-top: 5px;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      z-index: 1000;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .dropdown-list.open {
      max-height: 300px;
      overflow-y: auto;
    }

    .difficulty-option,
    .character-option {
      display: flex;
      align-items: center;
      padding: 12px 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 1px solid #eee;
    }

    .difficulty-option:last-child,
    .character-option:last-child {
      border-bottom: none;
    }

    .difficulty-option:hover,
    .character-option:hover {
      background: #f0f0f0;
    }

    .difficulty-option .emoji,
    .character-option .emoji {
      font-size: 1.5em;
      margin-right: 10px;
      width: 30px;
      text-align: center;
      flex-shrink: 0;
    }

    .difficulty-option .name,
    .character-option .name {
      font-size: 0.9em;
      color: #333;
      font-weight: bold;
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .start-game-btn {
      background: linear-gradient(45deg, #00b894, #00ced1);
      border: none;
      padding: 15px 40px;
      border-radius: 40px;
      font-size: clamp(1.1rem, 3vw, 1.5rem);
      color: white;
      cursor: pointer;
      font-family: arial;
      font-weight: bold;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease;
      margin-top: 20px;
      width: 90%;
      max-width: 400px;
    }

    .start-game-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    #gameScreen {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .game-header {
      text-align: center;
      margin-bottom: 15px;
      width: 100%;
    }

    .game-title {
      font-size: clamp(1.5rem, 5vw, 2rem);
      color: white;
      text-shadow: 2px 2px 0 rgba(0, 0, 0, 0.3);
      margin-bottom: 10px;
      padding: 0 10px;
    }
    
    .target-animal {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 15px;
      padding: 15px;
      margin-bottom: 15px;
      text-align: center;
      border: 4px solid #FF6B6B;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      width: 90%;
      max-width: 350px;
      animation: pulseTarget 2s infinite;
    }

    .target-title {
      font-size: clamp(1.1rem, 3vw, 1.5rem);
      color: #FF6B6B;
      margin-bottom: 10px;
      font-weight: bold;
    }

    .target-display {
      font-size: clamp(3rem, 10vw, 5rem);
      animation: glow 1.5s infinite;
      margin: 10px 0;
    }

    .game-info {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 15px;
      width: 90%;
      max-width: 350px;
    }

    .info-box {
      background: rgba(255, 255, 255, 0.9);
      padding: 10px 15px;
      border-radius: 12px;
      text-align: center;
      font-size: clamp(0.9rem, 3vw, 1.1rem);
      font-weight: bold;
      flex: 1;
    }

    .time-left {
      color: #e17055;
    }

    .score {
      color: #00b894;
    }

    .holes-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-bottom: 20px;
      max-width: 350px;
      width: 90%;
      margin-left: auto;
      margin-right: auto;
    }

    .hole {
      position: relative;
      width: 100%;
      aspect-ratio: 1;
      cursor: pointer;
    }

    .hole::before {
      content: '';
      position: absolute;
      width: 80%;
      height: 80%;
      background: #8b4513;
      border-radius: 50%;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      box-shadow: inset 0 -8px 15px rgba(0, 0, 0, 0.5);
      border: 6px solid #5d4037;
    }

    .animal {
      position: absolute;
      width: 70%;
      height: 70%;
      background: white;
      border-radius: 50%;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 2em;
      transition: all 0.4s ease;
      z-index: 2;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      border: 3px solid #ffd700;
    }

    .animal.pop-up {
      transform: translate(-50%, -100%) scale(1);
      animation: popUp 0.5s ease-out;
    }

    .animal.hit {
      animation: hitAnimation 0.4s ease;
      background: #ffeb3b;
    }

    .animal.wrong {
      animation: wrongHit 0.4s ease;
      background: #ff6b6b;
      border-color: #ff4757;
    }

    .controls {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      max-width: 350px;
      width: 90%;
      margin: 0 auto;
    }

    .control-btn {
      background: linear-gradient(45deg, #00b894, #00ced1);
      border: none;
      padding: 12px;
      border-radius: 15px;
      font-size: clamp(0.9rem, 2.5vw, 1.1rem);
      color: white;
      cursor: pointer;
      font-family: arial;
      font-weight: bold;
    }

    .game-over {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      justify-content: center;
      align-items: center;
      z-index: 2000;
      padding: 20px;
    }

    .game-over-content {
      background: linear-gradient(135deg, #ff6b6b, #ff8e53);
      padding: 25px;
      border-radius: 20px;
      text-align: center;
      max-width: 350px;
      width: 90%;
      color: white;
    }

    .final-score {
      font-size: clamp(2rem, 8vw, 3rem);
      color: #ffd700;
      margin: 15px 0;
    }

    @keyframes glow {
      0%,
      100% {
        text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
      }
      50% {
        text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
      }
    }

    @keyframes popUp {
      0% {
        transform: translate(-50%, -50%) scale(0);
      }
      70% {
        transform: translate(-50%, -120%) scale(1.1);
      }
      100% {
        transform: translate(-50%, -100%) scale(1);
      }
    }

    @keyframes hitAnimation {
      0% {
        transform: translate(-50%, -100%) scale(1);
      }
      50% {
        transform: translate(-50%, -100%) scale(1.3);
      }
      100% {
        transform: translate(-50%, -100%) scale(0);
      }
    }

    @keyframes wrongHit {
      0% {
        transform: translate(-50%, -100%) scale(1);
      }
      25% {
        transform: translate(-50%, -100%) scale(1.2) rotate(-5deg);
      }
      50% {
        transform: translate(-50%, -100%) scale(1.2) rotate(5deg);
      }
      100% {
        transform: translate(-50%, -100%) scale(0);
      }
    }

    @keyframes pulseTarget {
      0% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.03);
      }
      100% {
        transform: scale(1);
      }
    }

    @media (max-width: 480px) {
      .controls {
        grid-template-columns: 1fr;
      }
      
      .holes-container {
        gap: 8px;
      }
      
      .choose-title {
        padding: 8px 15px;
        margin: 10px 0;
      }
    }

    @media (max-width: 360px) {
      .screen {
        padding: 10px;
        padding-top: 70px;
      }
      
      .holes-container {
        max-width: 300px;
      }
      
      .target-animal {
        max-width: 300px;
      }
      
      .game-info {
        max-width: 300px;
      }
    }
  </style>
</head>

<body>
  <!-- Ad Banner -->
  <div class="ad-banner" id="adBanner">
    <span class="ad-emoji">üëâ</span>
    <span class="ad-text">Œ†Œ¨œÑŒ∑œÉŒµ Œ∫ŒªŒπŒ∫ Œ∫Œ±Œπ Œ≤ŒøŒÆŒ∏Œ∑œÉŒ≠ ŒºŒ±œÇ ŒΩŒ± œÉœÖŒΩŒµœáŒØœÉŒøœÖŒºŒµ!</span>
    <button class="ad-close" id="adClose">‚úï</button>
  </div>

  <div class="screen active" id="welcomeScreen">
    <h1 class="welcome-title">Magic Animal Holes!</h1>

    <h2 class="choose-title">üéØ ŒîŒπŒ¨ŒªŒµŒæŒµ ŒîœÖœÉŒ∫ŒøŒªŒØŒ±!</h2>

    <div class="difficulty-selector">
      <div class="dropdown-container">
        <div class="dropdown-header" id="difficultyDropdownHeader">
          <div class="selected-difficulty">
            <span class="selected-name" id="selectedDifficultyName">ŒïœÄŒ≠ŒªŒµŒæŒµ Œ¥œÖœÉŒ∫ŒøŒªŒØŒ±...</span>
          </div>
          <span class="dropdown-arrow">‚ñº</span>
        </div>
        <div class="dropdown-list" id="difficultyDropdownList"></div>
      </div>
    </div>

    <h2 class="choose-title">üéØ ŒîŒπŒ¨ŒªŒµŒæŒµ œÑŒø ŒñœâŒ¨Œ∫Œπ!</h2>

    <div class="character-selector">
      <div class="dropdown-container">
        <div class="dropdown-header" id="dropdownHeader">
          <div class="selected-character">
            <span class="selected-emoji">üêµ</span>
            <span class="selected-name">ŒïœÄŒ≠ŒªŒµŒæŒµ œáŒ±œÅŒ±Œ∫œÑŒÆœÅŒ±...</span>
          </div>
          <span class="dropdown-arrow">‚ñº</span>
        </div>
        <div class="dropdown-list" id="dropdownList"></div>
      </div>
    </div>

    <button class="start-game-btn" id="startGameBtn" disabled>üöÄ ŒàŒΩŒ±œÅŒæŒ∑ Œ†Œ±ŒπœáŒΩŒπŒ¥ŒπŒøœç</button>
  </div>

  <div class="screen" id="gameScreen">
    <div class="game-header">
      <h1 class="game-title">Œ†ŒøŒªŒªŒøŒØ ŒßŒ±œÅŒ±Œ∫œÑŒÆœÅŒµœÇ! üéØ</h1>
    </div>

    <div class="target-animal">
      <div class="target-title">üéØ Œ£œÑœåœáŒøœÇ:</div>
      <div class="target-display" id="targetAnimal">üêµ</div>
      <div>+<span id="targetPoints">10</span> Œ†œåŒΩœÑŒøŒπ Œ±ŒΩŒ¨ œáœÑœçœÄŒ∑ŒºŒ±</div>
    </div>

    <div class="game-info">
      <div class="info-box time-left">‚è∞ ŒßœÅœåŒΩŒøœÇ: <span id="timeLeft">60</span></div>
      <div class="info-box score">‚≠ê Score: <span id="score">0</span></div>
    </div>

    <div class="holes-container" id="holesContainer"></div>

    <div class="controls">
      <button class="control-btn" onclick="restartGame()">üîÑ ŒùŒ≠Œø Œ†Œ±ŒπœáŒΩŒØŒ¥Œπ</button>
      <button class="control-btn" onclick="showWelcomeScreen()">üè† ŒëœÅœáŒπŒ∫ŒÆ</button>
    </div>
  </div>

  <div class="game-over" id="gameOver">
    <div class="game-over-content">
      <h2>üéØ Œ§Œ≠ŒªŒøœÇ Œ†Œ±ŒπœáŒΩŒπŒ¥ŒπŒøœç!</h2>
      <div class="final-score" id="finalScore">0</div>
      
      <p id="gameMessage"></p>
      
      <div class="controls">
        <button class="control-btn" onclick="restartGame()">üéÆ Œ†Œ±ŒØŒæŒµ ŒûŒ±ŒΩŒ¨</button>
        <button class="control-btn" onclick="showWelcomeScreen()">üè† ŒëœÅœáŒπŒ∫ŒÆ</button>
      </div>
    </div>
  </div>

  <script>
    const config = {
      difficulties: {
        easy: {
          name: 'ŒïœçŒ∫ŒøŒªŒø',
          emoji: 'üü¢',
          time: 60,
          animalSpeed: 5000,
          animalVisible: 5000,
          charactersAtOnce: 4
        },
        medium: {
          name: 'ŒúŒ≠œÑœÅŒπŒø',
          emoji: 'üü°',
          time: 60,
          animalSpeed: 3500,
          animalVisible: 3500,
          charactersAtOnce: 4
        },
        hard: {
          name: 'ŒîœçœÉŒ∫ŒøŒªŒø',
          emoji: 'üî¥',
          time: 60,
          animalSpeed: 2000,
          animalVisible: 2000,
          charactersAtOnce: 4
        }
      },
      animals: [
        { emoji: 'üêµ', name: 'ŒúŒ±œäŒºŒøœç', points: 10 },
        { emoji: 'ü¶ä', name: 'ŒëŒªŒµœÄŒøœç', points: 7 },
        { emoji: 'ü¶Ñ', name: 'ŒúŒøŒΩœåŒ∫ŒµœÅŒøœÇ', points: 15 },
        { emoji: 'ü¶Å', name: 'ŒõŒπŒøŒΩœÑŒ¨œÅŒπ', points: 12 },
        { emoji: 'üêº', name: 'Œ†Œ¨ŒΩœÑŒ±', points: 8 },
        { emoji: 'üê¨', name: 'ŒîŒµŒªœÜŒØŒΩŒπ', points: 9 },
        { emoji: 'üê∂', name: 'Œ£Œ∫œçŒªŒøœÇ', points: 6 },
        { emoji: 'üê±', name: 'ŒìŒ¨œÑŒ±', points: 5 },
        { emoji: 'üê∞', name: 'ŒöŒøœÖŒΩŒ≠ŒªŒπ', points: 4 },
        { emoji: 'üêª', name: 'ŒëœÅŒ∫ŒøœçŒ¥Œ±', points: 11 },
        { emoji: 'üêØ', name: 'Œ§ŒØŒ≥œÅŒ∑', points: 13 },
        { emoji: 'üê®', name: 'Koala', points: 8 },
        { emoji: 'üêπ', name: 'ŒßŒ±ŒºœÉœÑŒµœÅ', points: 5 },
        { emoji: 'ü¶ù', name: 'Œ°Œ±Œ∫ŒøœçŒΩ', points: 9 },
        { emoji: 'üêøÔ∏è', name: 'Œ£Œ∫ŒØŒøœÖœÅŒøœÇ', points: 6 },
        { emoji: 'ü¶•', name: 'ŒíœÅŒ±Œ¥œçœÄŒøœÖœÇ', points: 14 },
        { emoji: 'ü¶¶', name: 'ŒíŒØŒ¥œÅŒ±', points: 11 },
        { emoji: 'üêæ', name: 'Capybara', points: 16 }
      ]
    };
    
    let selectedAnimal = null;
    let selectedDifficulty = null;
    let currentTargetAnimal = null;
    let score = 0;
    let timeLeft = 60;
    let timer;
    let gameStarted = false;
    let activeAnimals = [];
    let animalInterval;
    let dropdownOpen = {
      difficulty: false,
      character: false
    };
    let gamesPlayed = 0;
    let adBannerInterval;
    let flyingAdsInterval;

    // Sound objects
    const correctSound = new Audio('https://www.soundboard.com/media/2405');
    const wrongSound = new Audio('https://www.soundboard.com/media/2529');

    // Ad URLs
    const AD_URL = 'https://otieu.com/4/10274068';

    // Ad banner functionality
    function initializeAdBanner() {
      const adBanner = document.getElementById('adBanner');
      const adClose = document.getElementById('adClose');
      
      // Start banner animation
      setTimeout(() => {
        adBanner.classList.add('show');
      }, 1000);
      
      // Banner animation interval
      adBannerInterval = setInterval(() => {
        adBanner.classList.toggle('show');
      }, 20000); // Show every 20 seconds
      
      // Close button functionality
      adClose.addEventListener('click', function(e) {
        e.stopPropagation();
        adBanner.classList.remove('show');
      });
      
      // Banner click functionality
      adBanner.addEventListener('click', function() {
        window.open(AD_URL, '_blank');
        adBanner.classList.remove('show');
      });
    }

    // Flying ads functionality
    function createFlyingAd() {
      if (!gameStarted && document.getElementById('welcomeScreen').classList.contains('active')) {
        return; // Don't show flying ads on welcome screen
      }
      
      const flyingAd = document.createElement('div');
      flyingAd.className = 'flying-ad';
      
      // Select random animal
      const randomAnimal = config.animals[Math.floor(Math.random() * config.animals.length)];
      
      flyingAd.innerHTML = `
        <div class="ad-label">ads</div>
        ${randomAnimal.emoji}
      `;
      
      // Random position
      const startX = Math.random() * window.innerWidth;
      const startY = Math.random() * window.innerHeight;
      
      // Random animation type
      const animations = ['flyTopToBottom', 'flyBottomToTop', 'flyLeftToRight', 'flyRightToLeft'];
      const randomAnimation = animations[Math.floor(Math.random() * animations.length)];
      
      flyingAd.style.left = `${startX}px`;
      flyingAd.style.top = `${startY}px`;
      flyingAd.style.animationName = randomAnimation;
      
      // Random duration
      flyingAd.style.animationDuration = `${15 + Math.random() * 10}s`;
      
      // Click event
      flyingAd.addEventListener('click', function() {
        window.open(AD_URL, '_blank');
        document.body.removeChild(flyingAd);
      });
      
      // Auto-remove after animation completes
      setTimeout(() => {
        if (flyingAd.parentNode) {
          document.body.removeChild(flyingAd);
        }
      }, 25000);
      
      document.body.appendChild(flyingAd);
    }

    function startFlyingAds() {
      // Clear existing interval
      clearInterval(flyingAdsInterval);
      
      // Create first ad immediately
      setTimeout(() => createFlyingAd(), 1000);
      
      // Create ads at intervals
      flyingAdsInterval = setInterval(() => {
        if (gameStarted && Math.random() < 0.7) { // 70% chance during game
          createFlyingAd();
        } else if (!gameStarted && Math.random() < 0.3) { // 30% chance on other screens
          createFlyingAd();
        }
      }, 5000); // Every 5 seconds
    }

    function stopFlyingAds() {
      clearInterval(flyingAdsInterval);
      // Remove all existing flying ads
      document.querySelectorAll('.flying-ad').forEach(ad => ad.remove());
    }

    function initializeDropdowns() {
      // Initialize Difficulty Dropdown
      const difficultyList = document.getElementById('difficultyDropdownList');
      const difficultyNames = {
        easy: 'ŒïœçŒ∫ŒøŒªŒø',
        medium: 'ŒúŒ≠œÑœÅŒπŒø',
        hard: 'ŒîœçœÉŒ∫ŒøŒªŒø'
      };
      const difficultyEmojis = {
        easy: 'üü¢',
        medium: 'üü°',
        hard: 'üî¥'
      };
      
      Object.keys(config.difficulties).forEach(key => {
        const option = document.createElement('div');
        option.className = 'difficulty-option';
        option.innerHTML = `
          <span class="emoji">${difficultyEmojis[key]}</span>
          <span class="name">${difficultyNames[key]}</span>
        `;
        option.addEventListener('click', () => {
          selectDifficulty(key);
          toggleDropdown('difficulty');
        });
        difficultyList.appendChild(option);
      });

      document.getElementById('difficultyDropdownHeader').addEventListener('click', () => toggleDropdown('difficulty'));

      // Initialize Character Dropdown
      const characterList = document.getElementById('dropdownList');
      config.animals.forEach(animal => {
        const option = document.createElement('div');
        option.className = 'character-option';
        option.innerHTML = `
          <span class="emoji">${animal.emoji}</span>
          <span class="name">${animal.name}</span>
        `;
        option.addEventListener('click', () => {
          selectAnimal(animal);
          toggleDropdown('character');
        });
        characterList.appendChild(option);
      });
      document.getElementById('dropdownHeader').addEventListener('click', () => toggleDropdown('character'));

      // Close dropdowns when clicking outside
      document.addEventListener('click', (e) => {
        if (!e.target.closest('.difficulty-selector')) closeDropdown('difficulty');
        if (!e.target.closest('.character-selector')) closeDropdown('character');
      });
    }

    function toggleDropdown(type) {
      const list = type === 'difficulty' ? document.getElementById('difficultyDropdownList') : document.getElementById('dropdownList');
      const arrow = type === 'difficulty' ? document.querySelector('.difficulty-selector .dropdown-arrow') : document.querySelector('.character-selector .dropdown-arrow');
      
      dropdownOpen[type] = !dropdownOpen[type];
      list.classList.toggle('open', dropdownOpen[type]);
      arrow.classList.toggle('open', dropdownOpen[type]);
    }

    function closeDropdown(type) {
      if (dropdownOpen[type]) {
        const list = type === 'difficulty' ? document.getElementById('difficultyDropdownList') : document.getElementById('dropdownList');
        const arrow = type === 'difficulty' ? document.querySelector('.difficulty-selector .dropdown-arrow') : document.querySelector('.character-selector .dropdown-arrow');
        dropdownOpen[type] = false;
        list.classList.remove('open');
        arrow.classList.remove('open');
      }
    }

    function selectDifficulty(difficulty) {
      selectedDifficulty = difficulty;
      const difficultyInfo = config.difficulties[difficulty];
      document.getElementById('selectedDifficultyName').textContent = difficultyInfo.name;
      checkStartButton();
    }

    function selectAnimal(animal) {
      selectedAnimal = animal;
      document.querySelector('.selected-emoji').textContent = animal.emoji;
      document.querySelector('.selected-name').textContent = animal.name;
      document.querySelector('.selected-name').style.color = '#333';
      checkStartButton();
    }

    function checkStartButton() {
      document.getElementById('startGameBtn').disabled = !(selectedAnimal && selectedDifficulty);
    }

    function showWelcomeScreen() {
      document.getElementById('welcomeScreen').classList.add('active');
      document.getElementById('gameScreen').classList.remove('active');
      document.getElementById('gameOver').style.display = 'none';
      stopGame();
      stopFlyingAds();
      startFlyingAds(); // Start flying ads on welcome screen
      closeDropdown('difficulty');
      closeDropdown('character');
    }

    function showGameScreen() {
      if (!selectedAnimal || !selectedDifficulty) return;
      document.getElementById('welcomeScreen').classList.remove('active');
      document.getElementById('gameScreen').classList.add('active');
      document.getElementById('gameOver').style.display = 'none';
      
      // Preload sounds
      correctSound.volume = 0.3;
      wrongSound.volume = 0.3;
      correctSound.play().then(() => correctSound.pause()).catch(e => {});
      wrongSound.play().then(() => wrongSound.pause()).catch(e => {});
      
      currentTargetAnimal = selectedAnimal;
      document.getElementById('targetAnimal').textContent = currentTargetAnimal.emoji;
      document.getElementById('targetPoints').textContent = currentTargetAnimal.points;
      document.getElementById('timeLeft').textContent = config.difficulties[selectedDifficulty].time;
      startGame();
      startFlyingAds(); // Start flying ads during game
    }

    function startGame() {
      gameStarted = true;
      score = 0;
      timeLeft = config.difficulties[selectedDifficulty].time;
      activeAnimals = [];
      updateDisplay();
      createHoles();
      startTimer();
      const difficultyConfig = config.difficulties[selectedDifficulty];
      clearInterval(animalInterval);
      setTimeout(() => {
        showMultipleAnimals();
        animalInterval = setInterval(showMultipleAnimals, difficultyConfig.animalSpeed);
      }, 500);
    }

    function createHoles() {
      const container = document.getElementById('holesContainer');
      container.innerHTML = '';
      for (let i = 0; i < 6; i++) {
        const hole = document.createElement('div');
        hole.className = 'hole';
        hole.dataset.index = i;
        const animal = document.createElement('div');
        animal.className = 'animal';
        animal.textContent = '?';
        hole.appendChild(animal);
        hole.addEventListener('click', () => hitAnimal(hole));
        container.appendChild(hole);
      }
    }

    function showMultipleAnimals() {
      if (!gameStarted) return;
      const holes = document.querySelectorAll('.hole');
      const availableHoles = Array.from(holes).filter(hole =>
        !hole.querySelector('.animal').classList.contains('pop-up')
      );
      if (availableHoles.length === 0) return;
      const difficultyConfig = config.difficulties[selectedDifficulty];
      const numberOfAnimals = Math.min(difficultyConfig.charactersAtOnce, availableHoles.length);
      const randomHoles = [];
      while (randomHoles.length < numberOfAnimals && availableHoles.length > 0) {
        const randomIndex = Math.floor(Math.random() * availableHoles.length);
        randomHoles.push(availableHoles[randomIndex]);
        availableHoles.splice(randomIndex, 1);
      }
      randomHoles.forEach(hole => {
        const animalElement = hole.querySelector('.animal');
        let animalToShow;
        if (Math.random() < 0.3) {
          animalToShow = currentTargetAnimal;
        } else {
          const otherAnimals = config.animals.filter(a => a.emoji !== currentTargetAnimal.emoji);
          animalToShow = otherAnimals[Math.floor(Math.random() * otherAnimals.length)];
        }
        animalElement.textContent = animalToShow.emoji;
        animalElement.dataset.animalType = animalToShow.emoji;
        animalElement.classList.add('pop-up');
        activeAnimals.push(animalElement);
        setTimeout(() => {
          if (animalElement.classList.contains('pop-up')) {
            hideAnimal(animalElement);
          }
        }, difficultyConfig.animalVisible);
      });
    }

    function hideAnimal(animalElement) {
      animalElement.classList.remove('pop-up', 'hit', 'wrong');
      animalElement.textContent = '?';
      activeAnimals = activeAnimals.filter(a => a !== animalElement);
    }

    function hitAnimal(hole) {
      if (!gameStarted) return;
      const animalElement = hole.querySelector('.animal');
      if (animalElement.classList.contains('pop-up') && !animalElement.classList.contains('hit')) {
        const animalType = animalElement.dataset.animalType;
        if (animalType === currentTargetAnimal.emoji) {
          animalElement.classList.add('hit');
          score += currentTargetAnimal.points;
          correctSound.currentTime = 0;
          correctSound.play().catch(e => {});
        } else {
          animalElement.classList.add('wrong');
          score = Math.max(0, score - 3);
          wrongSound.currentTime = 0;
          wrongSound.play().catch(e => {});
        }
        updateDisplay();
        setTimeout(() => hideAnimal(animalElement), 400);
      }
    }

    function updateDisplay() {
      document.getElementById('score').textContent = score;
      document.getElementById('timeLeft').textContent = timeLeft;
    }

    function startTimer() {
      clearInterval(timer);
      timer = setInterval(() => {
        timeLeft--;
        updateDisplay();
        if (timeLeft <= 0) endGame();
      }, 1000);
    }

    function stopGame() {
      gameStarted = false;
      clearInterval(timer);
      clearInterval(animalInterval);
      activeAnimals.forEach(hideAnimal);
    }

    function endGame() {
      stopGame();
      stopFlyingAds();
      gamesPlayed++;
      const finalScore = document.getElementById('finalScore');
      const gameMessage = document.getElementById('gameMessage');
      
      finalScore.textContent = score;
      if (score >= 100) {
        gameMessage.textContent = 'üéâ ŒïŒæŒ±ŒπœÅŒµœÑŒπŒ∫Œ¨! Œ†ŒøŒªŒªŒøœçœÇ œÉœÑœåœáŒøœÖœÇ Œ≤œÅŒÆŒ∫ŒµœÇ!';
      } else if (score >= 50) {
        gameMessage.textContent = 'üëç Œ†ŒøŒªœç Œ∫Œ±ŒªŒ¨! Œ£œÖŒΩŒµœáŒØœÉœÑŒµ Œ≠œÑœÉŒπ!';
      } else {
        gameMessage.textContent = 'üí™ ŒöŒ±ŒªŒÆ œÄœÅŒøœÉœÄŒ¨Œ∏ŒµŒπŒ±! ŒåŒªŒø Œ∫Œ±Œπ Œ∫Œ±ŒªœçœÑŒµœÅŒ±!';
      }

      document.getElementById('gameOver').style.display = 'flex';
      startFlyingAds(); // Start flying ads on game over screen
    }

    function restartGame() {
      document.getElementById('gameOver').style.display = 'none';
      startGame();
      startFlyingAds();
    }
    
    // Initialize
    window.addEventListener('DOMContentLoaded', function() {
      initializeDropdowns();
      initializeAdBanner();
      startFlyingAds(); // Start flying ads on initial load
      
      // Handle window resize
      window.addEventListener('resize', function() {
        // Remove flying ads that might be off-screen
        document.querySelectorAll('.flying-ad').forEach(ad => {
          const rect = ad.getBoundingClientRect();
          if (rect.right < 0 || rect.bottom < 0 || rect.left > window.innerWidth || rect.top > window.innerHeight) {
            ad.remove();
          }
        });
      });
    });
    
    document.getElementById('startGameBtn').addEventListener('click', showGameScreen);
    
    // Touch optimizations
    document.addEventListener('touchstart', (e) => {
      if (e.touches.length > 1) e.preventDefault();
    }, { passive: false });
  </script>
</body>
</html>
